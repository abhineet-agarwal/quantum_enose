
======================================================================
IETS SIMULATION: Benzene on GaAs/AlAs RTD (Quasi-3D)
======================================================================

Configuration:
  Device: GaAs_AlAs_symmetric
  Molecule: Benzene
  Quasi-3D: 3×3 = 9 transverse modes
  Energy grid: 50 points (-0.2 to 1.0 eV)
  Bias sweep: 7 points (0.0 to 0.3 V)
  SCBA: max 20 iterations, tol=1e-03

======================================================================
RUNNING SIMULATION...
======================================================================

======================================================================
IETS SIMULATION: Benzene on GaAs_AlAs_symmetric
======================================================================

[1/5] Setting up device and molecule...
  Transverse modes: 9 total (3×3)
    Mode energies: 0.011 to 0.101 meV
    Dimensions: Ly=1.00 µm, Lz=1.00 µm
  Device: 71 grid points, 21.0 nm
  Molecule: Benzene (5 vibrational modes)
  Total phonon modes: 6 (1 bulk + 5 molecular)
  Mode-dependent molecular coupling:
    First vibrational mode: D_min=0.000 meV, D_max=20000000000000.004 meV
    Modes with >1% coupling: 4/9

[2/5] Creating energy grid...
  Energy range: -0.20 to 1.00 eV
  Points: 50 (dE = 24.5 meV)

[3/5] Computing contact self-energies...
  Contact broadenings computed for 50 energies

[4/5] Running bias sweep...
  Voltage: 0.00 to 0.30 V (7 points)

  --- Bias 1/7: V = 0.000 V ---
  Multimode SCBA: 9 transverse modes, 50 energies, 71 sites
  Iteration   0: residual = 7.735036e+23
  Iteration   1: residual = 2.320511e+23
  Iteration   2: residual = 1.624358e+23
  Iteration   3: residual = 1.137050e+23
  Iteration   4: residual = 7.959352e+22
  Iteration   5: residual = 5.571546e+22
  Iteration  10: residual = 9.364098e+21
  Iteration  15: residual = 1.573824e+21
  ⚠ Did not converge after 20 iterations (residual = 3.778751e+20)
  ⚠ I = 0.000 pA (iterations: 20)

  --- Bias 2/7: V = 0.050 V ---
  Multimode SCBA: 9 transverse modes, 50 energies, 71 sites
  Iteration   0: residual = 7.735036e+23
  Iteration   1: residual = 2.320511e+23
  Iteration   2: residual = 1.624358e+23
  Iteration   3: residual = 1.137050e+23
  Iteration   4: residual = 7.959352e+22
  Iteration   5: residual = 5.571546e+22
  Iteration  10: residual = 9.364098e+21
  Iteration  15: residual = 1.573824e+21
  ⚠ Did not converge after 20 iterations (residual = 3.778751e+20)
  ⚠ I = 4468.992 pA (iterations: 20)

  --- Bias 3/7: V = 0.100 V ---
  Multimode SCBA: 9 transverse modes, 50 energies, 71 sites
  Iteration   0: residual = 7.735036e+23
  Iteration   1: residual = 2.320511e+23
  Iteration   2: residual = 1.624358e+23
  Iteration   3: residual = 1.137050e+23
  Iteration   4: residual = 7.959352e+22
  Iteration   5: residual = 5.571546e+22
  Iteration  10: residual = 9.364098e+21
  Iteration  15: residual = 1.573824e+21
  ⚠ Did not converge after 20 iterations (residual = 3.778751e+20)
  ⚠ I = 13191.318 pA (iterations: 20)

  --- Bias 4/7: V = 0.150 V ---
  Multimode SCBA: 9 transverse modes, 50 energies, 71 sites
  Iteration   0: residual = 7.735036e+23
  Iteration   1: residual = 2.320511e+23
  Iteration   2: residual = 1.624358e+23
  Iteration   3: residual = 1.137050e+23
  Iteration   4: residual = 7.959352e+22
  Iteration   5: residual = 5.571546e+22
  Iteration  10: residual = 9.364098e+21
  Iteration  15: residual = 1.573824e+21
  ⚠ Did not converge after 20 iterations (residual = 3.778751e+20)
  ⚠ I = 34283.117 pA (iterations: 20)

  --- Bias 5/7: V = 0.200 V ---
  Multimode SCBA: 9 transverse modes, 50 energies, 71 sites
  Iteration   0: residual = 7.735036e+23
  Iteration   1: residual = 2.320511e+23
  Iteration   2: residual = 1.624358e+23
  Iteration   3: residual = 1.137050e+23
  Iteration   4: residual = 7.959352e+22
  Iteration   5: residual = 5.571546e+22
  Iteration  10: residual = 9.364098e+21
  Iteration  15: residual = 1.573824e+21
  ⚠ Did not converge after 20 iterations (residual = 3.778751e+20)
  ⚠ I = 87613.414 pA (iterations: 20)

  --- Bias 6/7: V = 0.250 V ---
  Multimode SCBA: 9 transverse modes, 50 energies, 71 sites
  Iteration   0: residual = 7.735036e+23
  Iteration   1: residual = 2.320511e+23
  Iteration   2: residual = 1.624358e+23
  Iteration   3: residual = 1.137050e+23
  Iteration   4: residual = 7.959352e+22
  Iteration   5: residual = 5.571546e+22
  Iteration  10: residual = 9.364098e+21
  Iteration  15: residual = 1.573824e+21
  ⚠ Did not converge after 20 iterations (residual = 3.778751e+20)
  ⚠ I = 223772.626 pA (iterations: 20)

  --- Bias 7/7: V = 0.300 V ---
  Multimode SCBA: 9 transverse modes, 50 energies, 71 sites
  Iteration   0: residual = 7.735036e+23
  Iteration   1: residual = 2.320511e+23
  Iteration   2: residual = 1.624358e+23
  Iteration   3: residual = 1.137050e+23
  Iteration   4: residual = 7.959352e+22
  Iteration   5: residual = 5.571546e+22
  Iteration  10: residual = 9.364098e+21
  Iteration  15: residual = 1.573824e+21
  ⚠ Did not converge after 20 iterations (residual = 3.778751e+20)
  ⚠ I = 564857.235 pA (iterations: 20)

[5/5] Computing IETS spectrum...
  dI/dV range: 8.938e-08 to 6.822e-06 S
  d²I/dV² range: 8.507e-07 to 4.927e-05 S/V
  Positive features: 7/7

======================================================================
SIMULATION COMPLETE in 339.3 seconds
======================================================================


======================================================================
SIMULATION COMPLETE!
======================================================================

Total time: 339.3 seconds (5.65 minutes)
Time per bias point: 48.5 seconds

======================================================================
RESULTS ANALYSIS
======================================================================

I-V Curve:
  Voltage range: 0.000 to 0.300 V
  Current range: 0.000 to 564.857 nA

Equilibrium check:
  I(V=0) = 0.000000 pA
  ✓ Perfect equilibrium (I = 0 at V = 0)

  V (V)     I (nA)    dI/dV (µS)   d²I/dV² (µS/V)
  --------------------------------------------------
  0.000      0.000      0.089        0.851
  0.050      4.469      0.132        2.088
  0.100     13.191      0.298        6.123
  0.150     34.283      0.744       15.968
  0.200     87.613      1.895       40.282
  0.250    223.773      4.772       49.268
  0.300    564.857      6.822       40.985

IETS Spectrum (d²I/dV²):
  Range: 0.851 to 49.268 µS/V
  Positive features: 7/7 points
  Maximum at: V = 0.250 V, d²I/dV² = 49.268 µS/V

SCBA Convergence:
  Converged bias points: 0/7
  Average iterations: 20.0

Transverse Modes:
  Total: 9
  Energies: 0.011 to 0.101 meV

======================================================================
SAVING RESULTS
======================================================================

Results saved to: results/output.csv

Result dictionary keys:
  config: SimulationConfig
  device: dict
  molecule: dict
  grid: dict
  phonon_modes: list
  E_array: array (50,)
  V_array: array (7,)
  I_array: array (7,)
  dIdV: array (7,)
  d2IdV2: array (7,)
  scba_results: list
  elapsed_time: float

======================================================================
PERFORMANCE ASSESSMENT
======================================================================

Computational Cost:
  Total time: 339.3 seconds
  Time per bias point: 48.5 seconds
  Estimated for 21 bias points: 1017.9 seconds (17.0 minutes)

  ⚠ Performance is SLOW (> 30 sec/point)
  Recommendation: Implement hybrid mode selection (7-8x speedup)

======================================================================
PHYSICS VALIDATION
======================================================================

Checking physical correctness:
  ✓ Detailed balance: I = 0 at V = 0
  ✓ Current increases with bias
  ✓ Forward bias gives positive current
  ✓ Current magnitude reasonable (564.9 nA)

======================================================================
✓ SIMULATION SUCCESSFUL!
======================================================================

