
======================================================================
IETS SIMULATION: Benzene on GaAs/AlAs RTD (Quasi-3D)
======================================================================

Configuration:
  Device: GaAs_AlAs_symmetric
  Molecule: Benzene
  Quasi-3D: 3×3 = 9 transverse modes
  Energy grid: 50 points (-0.2 to 1.0 eV)
  Bias sweep: 7 points (0.0 to 0.3 V)
  SCBA: max 50 iterations, tol=1e-02

======================================================================
RUNNING SIMULATION...
======================================================================

======================================================================
IETS SIMULATION: Benzene on GaAs_AlAs_symmetric
======================================================================

[1/5] Setting up device and molecule...
  Transverse modes: 9 total (3×3)
    Mode energies: 0.011 to 0.101 meV
    Dimensions: Ly=1.00 µm, Lz=1.00 µm
  Device: 71 grid points, 21.0 nm
  Molecule: Benzene (5 vibrational modes)
  Total phonon modes: 6 (1 bulk + 5 molecular)
  Mode-dependent molecular coupling:
    First vibrational mode: D_min=0.000 meV, D_max=5.000 meV
    Modes with >1% coupling: 4/9

[2/5] Creating energy grid...
  Energy range: -0.20 to 1.00 eV
  Points: 50 (dE = 24.5 meV)

[3/5] Computing contact self-energies...
  Contact broadenings computed for 50 energies

[4/5] Running bias sweep...
  Voltage: 0.00 to 0.30 V (7 points)

  --- Bias 1/7: V = 0.000 V ---
  Multimode SCBA: 9 transverse modes, 50 energies, 71 sites
  Iteration   0: residual = 3.615487e+01
  Iteration   1: residual = 2.349488e+01
  Iteration   2: residual = 1.495846e+01
  Iteration   3: residual = 9.548273e+00
  Iteration   4: residual = 7.396166e+00
  Iteration   5: residual = 5.862059e+00
  Iteration  10: residual = 1.539237e+00
  Iteration  15: residual = 4.873529e-01
  Iteration  20: residual = 1.564856e-01
  Iteration  25: residual = 5.726486e-02
  Iteration  30: residual = 2.223733e-02
  Iteration  35: residual = 9.040877e-03
  ✓ Converged after 36 iterations
  ✓ I = 0.000 pA (iterations: 36)

  --- Bias 2/7: V = 0.050 V ---
  Multimode SCBA: 9 transverse modes, 50 energies, 71 sites
  Iteration   0: residual = 3.615487e+01
  Iteration   1: residual = 2.349488e+01
  Iteration   2: residual = 1.495846e+01
  Iteration   3: residual = 9.548273e+00
  Iteration   4: residual = 7.396166e+00
  Iteration   5: residual = 5.862059e+00
  Iteration  10: residual = 1.539237e+00
  Iteration  15: residual = 4.873529e-01
  Iteration  20: residual = 1.564856e-01
  Iteration  25: residual = 5.726486e-02
  Iteration  30: residual = 2.223733e-02
  Iteration  35: residual = 9.040877e-03
  ✓ Converged after 36 iterations
  ✓ I = 8064.306 pA (iterations: 36)

  --- Bias 3/7: V = 0.100 V ---
  Multimode SCBA: 9 transverse modes, 50 energies, 71 sites
  Iteration   0: residual = 3.615487e+01
  Iteration   1: residual = 2.349488e+01
  Iteration   2: residual = 1.495846e+01
  Iteration   3: residual = 9.548273e+00
  Iteration   4: residual = 7.396166e+00
  Iteration   5: residual = 5.862059e+00
  Iteration  10: residual = 1.539237e+00
  Iteration  15: residual = 4.873529e-01
  Iteration  20: residual = 1.564856e-01
  Iteration  25: residual = 5.726486e-02
  Iteration  30: residual = 2.223733e-02
  Iteration  35: residual = 9.040877e-03
  ✓ Converged after 36 iterations
  ✓ I = 23804.847 pA (iterations: 36)

  --- Bias 4/7: V = 0.150 V ---
  Multimode SCBA: 9 transverse modes, 50 energies, 71 sites
  Iteration   0: residual = 3.615487e+01
  Iteration   1: residual = 2.349488e+01
  Iteration   2: residual = 1.495846e+01
  Iteration   3: residual = 9.548273e+00
  Iteration   4: residual = 7.396166e+00
  Iteration   5: residual = 5.862059e+00
  Iteration  10: residual = 1.539237e+00
  Iteration  15: residual = 4.873529e-01
  Iteration  20: residual = 1.564856e-01
  Iteration  25: residual = 5.726486e-02
  Iteration  30: residual = 2.223733e-02
  Iteration  35: residual = 9.040877e-03
  ✓ Converged after 36 iterations
  ✓ I = 61871.335 pA (iterations: 36)

  --- Bias 5/7: V = 0.200 V ---
  Multimode SCBA: 9 transverse modes, 50 energies, 71 sites
  Iteration   0: residual = 3.615487e+01
  Iteration   1: residual = 2.349488e+01
  Iteration   2: residual = 1.495846e+01
  Iteration   3: residual = 9.548273e+00
  Iteration   4: residual = 7.396166e+00
  Iteration   5: residual = 5.862059e+00
  Iteration  10: residual = 1.539237e+00
  Iteration  15: residual = 4.873529e-01
  Iteration  20: residual = 1.564856e-01
  Iteration  25: residual = 5.726486e-02
  Iteration  30: residual = 2.223733e-02
  Iteration  35: residual = 9.040877e-03
  ✓ Converged after 36 iterations
  ✓ I = 158129.850 pA (iterations: 36)

  --- Bias 6/7: V = 0.250 V ---
  Multimode SCBA: 9 transverse modes, 50 energies, 71 sites
  Iteration   0: residual = 3.615487e+01
  Iteration   1: residual = 2.349488e+01
  Iteration   2: residual = 1.495846e+01
  Iteration   3: residual = 9.548273e+00
  Iteration   4: residual = 7.396166e+00
  Iteration   5: residual = 5.862059e+00
  Iteration  10: residual = 1.539237e+00
  Iteration  15: residual = 4.873529e-01
  Iteration  20: residual = 1.564856e-01
  Iteration  25: residual = 5.726486e-02
  Iteration  30: residual = 2.223733e-02
  Iteration  35: residual = 9.040877e-03
  ✓ Converged after 36 iterations
  ✓ I = 403906.108 pA (iterations: 36)

  --- Bias 7/7: V = 0.300 V ---
  Multimode SCBA: 9 transverse modes, 50 energies, 71 sites
  Iteration   0: residual = 3.615487e+01
  Iteration   1: residual = 2.349488e+01
  Iteration   2: residual = 1.495846e+01
  Iteration   3: residual = 9.548273e+00
  Iteration   4: residual = 7.396166e+00
  Iteration   5: residual = 5.862059e+00
  Iteration  10: residual = 1.539237e+00
  Iteration  15: residual = 4.873529e-01
  Iteration  20: residual = 1.564856e-01
  Iteration  25: residual = 5.726486e-02
  Iteration  30: residual = 2.223733e-02
  Iteration  35: residual = 9.040877e-03
  ✓ Converged after 36 iterations
  ✓ I = 1019644.531 pA (iterations: 36)

[5/5] Computing IETS spectrum...
  dI/dV range: 1.613e-07 to 1.231e-05 S
  d²I/dV² range: 1.535e-06 to 8.894e-05 S/V
  Positive features: 7/7

======================================================================
SIMULATION COMPLETE in 603.1 seconds
======================================================================


======================================================================
SIMULATION COMPLETE!
======================================================================

Total time: 603.1 seconds (10.05 minutes)
Time per bias point: 86.2 seconds

======================================================================
RESULTS ANALYSIS
======================================================================

I-V Curve:
  Voltage range: 0.000 to 0.300 V
  Current range: 0.000 to 1019.645 nA

Equilibrium check:
  I(V=0) = 0.000000 pA
  ✓ Perfect equilibrium (I = 0 at V = 0)

  V (V)     I (nA)    dI/dV (µS)   d²I/dV² (µS/V)
  --------------------------------------------------
  0.000      0.000      0.161        1.535
  0.050      8.064      0.238        3.768
  0.100     23.805      0.538       11.052
  0.150     61.871      1.343       28.823
  0.200    158.130      3.420       72.719
  0.250    403.906      8.615       88.944
  0.300    1019.645     12.315       73.992

IETS Spectrum (d²I/dV²):
  Range: 1.535 to 88.944 µS/V
  Positive features: 7/7 points
  Maximum at: V = 0.250 V, d²I/dV² = 88.944 µS/V

SCBA Convergence:
  Converged bias points: 7/7
  Average iterations: 36.0

Transverse Modes:
  Total: 9
  Energies: 0.011 to 0.101 meV

======================================================================
SAVING RESULTS
======================================================================

Results saved to: results/output.csv

Result dictionary keys:
  config: SimulationConfig
  device: dict
  molecule: dict
  grid: dict
  phonon_modes: list
  E_array: array (50,)
  V_array: array (7,)
  I_array: array (7,)
  dIdV: array (7,)
  d2IdV2: array (7,)
  scba_results: list
  elapsed_time: float

======================================================================
PERFORMANCE ASSESSMENT
======================================================================

Computational Cost:
  Total time: 603.1 seconds
  Time per bias point: 86.2 seconds
  Estimated for 21 bias points: 1809.2 seconds (30.2 minutes)

  ⚠ Performance is SLOW (> 30 sec/point)
  Recommendation: Implement hybrid mode selection (7-8x speedup)

======================================================================
PHYSICS VALIDATION
======================================================================

Checking physical correctness:
  ✓ Detailed balance: I = 0 at V = 0
  ✓ Current increases with bias
  ✓ Forward bias gives positive current
  ⚠ Current magnitude unusual (1019.6 nA)

======================================================================
✓ SIMULATION SUCCESSFUL!
======================================================================

